--[[
	Backdoor Scanner GUI - By Team T00kshaf1y
	ËûçÂêà‰∫ÜÂ§ö‰∏™Êâ´ÊèèÂô®ÁöÑÂäüËÉΩ
]]

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local HttpService = game:GetService("HttpService")
local UserInputService = game:GetService("UserInputService")

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = Players.LocalPlayer:WaitForChild("PlayerGui")
screenGui.Name = "BackdoorScannerGui"

-- Create Draggable Frame
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 500, 0, 450)
frame.Position = UDim2.new(0.5, -250, 0.5, -225)
frame.BackgroundColor3 = Color3.fromRGB(0, 255, 255) -- ÈùíËâ≤ËÉåÊôØ
frame.BorderSizePixel = 0
frame.Parent = screenGui

-- Make Frame Draggable
local dragging, dragInput, dragStart, startPos
frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = frame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)
frame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement and dragging then
        local delta = input.Position - dragStart
        frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- Create ScrollingFrame for Output
local scrollFrame = Instance.new("ScrollingFrame")
scrollFrame.Size = UDim2.new(0.9, 0, 0, 250)
scrollFrame.Position = UDim2.new(0.05, 0, 0, 160)
scrollFrame.BackgroundTransparency = 1
scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
scrollFrame.ScrollBarThickness = 8
scrollFrame.Parent = frame

-- Main Title Label
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 40)
title.Position = UDim2.new(0, 0, 0, 10)
title.BackgroundTransparency = 1
title.Text = "BACKDOOR SCANNER"
title.TextColor3 = Color3.fromRGB(0, 0, 0)
title.Font = Enum.Font.Code
title.TextSize = 24
title.TextStrokeTransparency = 0
title.Parent = frame

-- Subtitle Label
local subtitle = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 30)
title.Position = UDim2.new(0, 0, 0, 50)
title.BackgroundTransparency = 1
title.Text = "By Team T00kshaf1y"
title.TextColor3 = Color3.fromRGB(0, 0, 0)
title.Font = Enum.Font.Code
title.TextSize = 16
title.TextStrokeTransparency = 0
title.Parent = frame

-- Status Label
local statusLabel = Instance.new("TextLabel")
statusLabel.Size = UDim2.new(0.9, 0, 0, 30)
statusLabel.Position = UDim2.new(0.05, 0, 0, 85)
statusLabel.BackgroundTransparency = 1
statusLabel.Text = "Ready to scan..."
statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
statusLabel.Font = Enum.Font.Code
statusLabel.TextSize = 14
statusLabel.Parent = frame

-- Scan Button
local scanButton = Instance.new("TextButton")
scanButton.Size = UDim2.new(0.45, 0, 0, 40)
scanButton.Position = UDim2.new(0.05, 0, 0, 120)
scanButton.BackgroundColor3 = Color3.fromRGB(0, 100, 0)
scanButton.TextColor3 = Color3.fromRGB(255, 255, 255)
scanButton.Font = Enum.Font.Code
scanButton.TextSize = 16
scanButton.Text = "SCAN"
scanButton.Parent = frame

-- Clear Button
local clearButton = Instance.new("TextButton")
clearButton.Size = UDim2.new(0.45, 0, 0, 40)
clearButton.Position = UDim2.new(0.5, 0, 0, 120)
clearButton.BackgroundColor3 = Color3.fromRGB(100, 0, 0)
clearButton.TextColor3 = Color3.fromRGB(255, 255, 255)
clearButton.Font = Enum.Font.Code
clearButton.TextSize = 16
clearButton.Text = "CLEAR"
clearButton.Parent = frame

-- Admin Button
local adminButton = Instance.new("TextButton")
adminButton.Size = UDim2.new(0.9, 0, 0, 40)
adminButton.Position = UDim2.new(0.05, 0, 0, 420)
adminButton.BackgroundColor3 = Color3.fromRGB(255, 165, 0)
adminButton.TextColor3 = Color3.fromRGB(255, 255, 255)
adminButton.Font = Enum.Font.Code
adminButton.TextSize = 16
adminButton.Text = "GRANT ADMIN (IF BACKDOORS FOUND)"
adminButton.Visible = false
adminButton.Parent = frame

-- Output Message List
local messages = {}
local messageHeight = 25
local detectedBackdoors = {}

local function addMessage(text, color, isKey)
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, -10, 0, messageHeight)
    label.Position = UDim2.new(0, 5, 0, #messages * messageHeight)
    label.BackgroundTransparency = 1
    label.Text = "  " .. text
    label.TextColor3 = color or Color3.fromRGB(255, 255, 255)
    label.Font = Enum.Font.Code
    label.TextSize = 12
    label.TextWrapped = true
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = scrollFrame

    table.insert(messages, label)
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, #messages * messageHeight)
end

-- Clear Messages
local function clearMessages()
    for _, msg in ipairs(messages) do
        msg:Destroy()
    end
    messages = {}
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
    adminButton.Visible = false
    detectedBackdoors = {}
    statusLabel.Text = "Ready to scan..."
    statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
end

-- Enhanced Backdoor Patterns
local patterns = {
    -- Remote execution patterns
    "loadstring%s*%(%s*game:HttpGet",
    "game:HttpGet%s*%(%s*[\"']https?://",
    "require%s*%(%s*%d%d%d%d%d%d%d%d%d%d+",
    "writefile",
    "syn%.request",
    "spawn%s*%(%s*function%s*%(%s*%)%s*while",
    "https?://[^'\"]*%.(tk|xyz|top|cf|ga|ml)/",
    
    -- Common backdoor indicators
    "FireServer",
    "InvokeServer",
    "RemoteEvent",
    "RemoteFunction",
    "BindableEvent",
    "BindableFunction",
    
    -- Suspicious commands
    "admin",
    "kick",
    "ban",
    "crash",
    "shutdown",
    "execute",
    "script",
    
    -- Data stealing patterns
    "getcookie",
    "setclipboard",
    "readfile",
    "delfile",
    "listfiles"
}

-- Enhanced Scanning Function
local function scanForBackdoors()
    statusLabel.Text = "SCANNING... Please wait"
    statusLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
    
    addMessage("=== BACKDOOR SCANNER STARTED ===", Color3.fromRGB(0, 255, 255))
    addMessage("Scanning all game objects...", Color3.fromRGB(255, 255, 255))
    
    local foundCount = 0
    local scannedCount = 0
    
    -- Scan all descendants
    for _, obj in ipairs(game:GetDescendants()) do
        scannedCount = scannedCount + 1
        
        -- Check object names for suspicious patterns
        local objName = obj.Name:lower()
        local suspiciousNames = {"backdoor", "admin", "execute", "script", "remote", "hidden", "secret"}
        
        for _, suspicious in ipairs(suspiciousNames) do
            if objName:find(suspicious) then
                foundCount = foundCount + 1
                addMessage(string.format("SUSPICIOUS NAME: %s", obj:GetFullName()), Color3.fromRGB(255, 165, 0))
                table.insert(detectedBackdoors, {obj = obj, type = "suspicious_name"})
                break
            end
        end
        
        -- Check scripts for malicious code
        if obj:IsA("Script") or obj:IsA("LocalScript") or obj:IsA("ModuleScript") then
            local success, src = pcall(function()
                return obj.Source or ""
            end)
            
            if success and src ~= "" then
                local lineNum = 0
                for line in src:gmatch("[^\n]+") do
                    lineNum = lineNum + 1
                    for _, pattern in ipairs(patterns) do
                        if line:find(pattern) then
                            foundCount = foundCount + 1
                            addMessage(string.format("MALICIOUS CODE: %s | Line %d", obj:GetFullName(), lineNum), Color3.fromRGB(255, 0, 0))
                            addMessage("   Pattern: " .. pattern, Color3.fromRGB(255, 100, 100))
                            addMessage("   Code: " .. line:sub(1, 80), Color3.fromRGB(200, 200, 200))
                            table.insert(detectedBackdoors, {obj = obj, type = "malicious_code", pattern = pattern})
                            break
                        end
                    end
                end
            end
        end
        
        -- Check for remote objects
        if obj:IsA("RemoteEvent") or obj:IsA("RemoteFunction") then
            foundCount = foundCount + 1
            addMessage(string.format("REMOTE OBJECT: %s", obj:GetFullName()), Color3.fromRGB(255, 255, 0))
            table.insert(detectedBackdoors, {obj = obj, type = "remote_object"})
        end
    end
    
    -- Scan core game services
    local services = {
        ReplicatedStorage,
        game:GetService("Workspace"),
        game:GetService("Lighting"),
        game:GetService("StarterPack"),
        game:GetService("StarterGui"),
        game:GetService("StarterPlayer")
    }
    
    for _, service in ipairs(services) do
        addMessage(string.format("Scanning service: %s", service.Name), Color3.fromRGB(100, 100, 255))
    end
    
    -- Final results
    addMessage("=== SCAN COMPLETE ===", Color3.fromRGB(0, 255, 255))
    
    if foundCount == 0 then
        addMessage("‚úÖ NO BACKDOORS DETECTED", Color3.fromRGB(0, 255, 0))
        statusLabel.Text = "SCAN COMPLETE - NO THREATS FOUND"
        statusLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
    else
        addMessage(string.format("üö® %d POTENTIAL THREATS DETECTED!", foundCount), Color3.fromRGB(255, 0, 0))
        statusLabel.Text = string.format("SCAN COMPLETE - %d THREATS FOUND", foundCount)
        statusLabel.TextColor3 = Color3.fromRGB(255, 0, 0)
        adminButton.Visible = true
    end
    
    addMessage(string.format("Scanned %d objects total", scannedCount), Color3.fromRGB(200, 200, 200))
end

-- Admin Access Function
local function attemptAdminAccess()
    addMessage("=== ATTEMPTING ADMIN ACCESS ===", Color3.fromRGB(255, 165, 0))
    
    for _, backdoor in ipairs(detectedBackdoors) do
        local obj = backdoor.obj
        
        if obj:IsA("RemoteEvent") then
            local commands = {
                "admin " .. Players.LocalPlayer.Name,
                "giveadmin " .. Players.LocalPlayer.Name,
                "promote " .. Players.LocalPlayer.Name,
                "makeadmin " .. Players.LocalPlayer.Name,
                "!admin " .. Players.LocalPlayer.Name
            }
            
            for _, cmd in ipairs(commands) do
                pcall(function()
                    obj:FireServer(cmd)
                    addMessage("Fired command: " .. cmd, Color3.fromRGB(0, 255, 0))
                end)
            end
        elseif obj:IsA("RemoteFunction") then
            local commands = {
                "admin " .. Players.LocalPlayer.Name,
                "giveadmin " .. Players.LocalPlayer.Name
            }
            
            for _, cmd in ipairs(commands) do
                pcall(function()
                    obj:InvokeServer(cmd)
                    addMessage("Invoked command: " .. cmd, Color3.fromRGB(0, 255, 0))
                end)
            end
        end
    end
    
    addMessage("Admin access attempts completed", Color3.fromRGB(255, 165, 0))
end

-- Button Connections
scanButton.MouseButton1Click:Connect(scanForBackdoors)
clearButton.MouseButton1Click:Connect(clearMessages)
adminButton.MouseButton1Click:Connect(attemptAdminAccess)

-- Add rounded corners
local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 8)
corner.Parent = frame

-- Add initial message
addMessage("Backdoor Scanner by Team T00kshaf1y", Color3.fromRGB(0, 255, 255))
addMessage("Click SCAN to begin detection", Color3.fromRGB(255, 255, 255))
addMessage("", Color3.fromRGB(255, 255, 255))

print("Backdoor Scanner GUI loaded successfully!")
print("By Team T00kshaf1y")
